# RECIPE Protocol Verification

This repository contains a Tamarin model and lemmas for the protocols presented in the RECIPE paper.
For installation of the Tamarin prover (version 1.10.0) refer to the [Tamarin documentation](https://tamarin-prover.com/manual/master/book/002_installation.html).
Alternatively use the provided [nix](https://nixos.org/download/) configuration by running `nix-shell`.

The model and lemmas are specified in `recipe_protocols.spthy`.

The full output including the proof generated by Tamarin is contained in `proofs/recipe_protocols_analyzed.spthy`.
The proof was automatically generated using `make all`, and successfully finished after ~3.4min (202 seconds) on an *Intel(R) Xeon(R) Gold 6438Y+* processor with *500GB* of RAM. An automatically generated summary of summaries is contained in `proofs/recipe_protocols_summary.txt`. Tamarin calls `recipe_oracle.py` to speed up the computation of certain lemmas during the proving process.

The model can also be explored interactively by running `tamarin-prover interactive .` in this directory.


## Assumptions

We assume that all the assumptions of the symbolic model and the tamarin prover hold, including:

* All messages are composed of atomic terms using predefined functions.
* All cryptographic functions are perfect with no side-effects.
* Attackers can read and delete all messages that are sent on the network and modify them in accordance with the set of available functions.

We utilize the results of the following previous TLS verification work to abstract the TLS handshake and subsequent connection as a secure channel in our model:

* [A Comprehensive Symbolic Analysis of TLS 1.3](https://people.cispa.io/cas.cremers/downloads/papers/CHSV2016-TLS13.pdf)
* [Automated Analysis and Verification of TLS 1.3: 0-RTT, Resumption and Delayed Authentication](https://acmccs.github.io/papers/p1773-cremersA.pdf)
* [TLS_Handshake.spthy](https://github.com/tamarin-prover/tamarin-prover/blob/develop/examples/classic/TLS_Handshake.spthy)
